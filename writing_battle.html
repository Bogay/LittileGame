<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>äº”è¡Œæ¼¢å­—å¤§æˆ°</title>
    <script src="https://cdn.jsdelivr.net/npm/cnchar/cnchar.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/cnchar-radical/cnchar.radical.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/handwriting.io@1.2.1/handwriting.min.js"></script>
    
    <style>
        :root {
            --metal: #cfd8dc; /* é‡‘ */
            --wood: #66bb6a;  /* æœ¨ */
            --water: #42a5f5; /* æ°´ */
            --fire: #ef5350;  /* ç« */
            --earth: #8d6e63; /* åœŸ */
            --bg: #263238;
        }
        body {
            font-family: 'Microsoft JhengHei', sans-serif;
            background-color: var(--bg);
            color: white;
            margin: 0; padding: 0;
            height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow: hidden;
            user-select: none;
        }

        /* é ‚éƒ¨è³‡è¨Š */
        .top-bar {
            width: 100%; padding: 10px; background: rgba(0,0,0,0.5);
            display: flex; justify-content: space-between; align-items: center;
            box-sizing: border-box; font-size: 18px; font-weight: bold;
        }

        /* æˆ°é¬¥å€åŸŸ */
        .battle-stage {
            flex: 1; width: 100%; max-width: 600px;
            position: relative;
            display: flex; justify-content: space-around; align-items: center;
            background-image: radial-gradient(circle, #37474f 0%, #263238 80%);
        }

        /* è§’è‰²å¡ */
        .fighter {
            display: flex; flex-direction: column; align-items: center;
            width: 120px; position: relative; transition: transform 0.2s;
        }
        .fighter-avatar { font-size: 80px; filter: drop-shadow(0 0 10px rgba(255,255,255,0.2)); }
        .hp-bar-box { width: 100%; height: 10px; background: #555; border-radius: 5px; overflow: hidden; margin-top: 5px; border: 1px solid white;}
        .hp-bar { height: 100%; background: #4caf50; width: 100%; transition: width 0.3s; }
        .attr-icon {
            position: absolute; top: -10px; right: -10px;
            width: 35px; height: 35px; border-radius: 50%;
            display: flex; justify-content: center; align-items: center;
            font-size: 18px; font-weight: bold; border: 2px solid white;
            box-shadow: 0 0 10px black;
        }

        /* å±¬æ€§é¡è‰²é¡åˆ¥ */
        .metal { background: var(--metal); color: #333; }
        .wood { background: var(--wood); color: #fff; }
        .water { background: var(--water); color: #fff; }
        .fire { background: var(--fire); color: #fff; }
        .earth { background: var(--earth); color: #fff; }

        /* æ‰‹å¯«å€èˆ‡è¨ˆæ™‚å™¨ */
        .input-zone {
            width: 100%; max-width: 500px;
            background: #fff; border-radius: 20px 20px 0 0;
            padding: 15px; display: flex; flex-direction: column; align-items: center;
            position: relative;
        }
        
        /* å€’æ•¸è¨ˆæ™‚æ¢ */
        .timer-bar-container {
            width: 100%; height: 15px; background: #ddd;
            border-radius: 10px; margin-bottom: 10px; overflow: hidden;
        }
        .timer-bar {
            height: 100%; background: #f44336; width: 100%;
            /* é€é JS æ§åˆ¶å‹•ç•« */
        }

        canvas {
            border: 3px dashed #aaa; border-radius: 10px;
            cursor: crosshair; touch-action: none;
            background-image: linear-gradient(#eee 1px, transparent 1px), linear-gradient(90deg, #eee 1px, transparent 1px);
            background-size: 40px 40px;
        }

        .status-text {
            color: #333; font-weight: bold; margin-bottom: 5px; min-height: 24px;
        }

        /* å‚·å®³ç‰¹æ•ˆ */
        .dmg-float {
            position: absolute; font-size: 40px; font-weight: 900;
            color: #ffeb3b; text-shadow: 3px 3px 0 #d32f2f;
            animation: floatUp 0.8s forwards; pointer-events: none; z-index: 100;
        }
        @keyframes floatUp { to { transform: translateY(-100px); opacity: 0; } }

        /* é®ç½© (æ•™å­¸/çµæŸ) */
        .overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.85); z-index: 200;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            color: white; text-align: center; padding: 20px;
        }
        .btn-start {
            padding: 15px 40px; font-size: 24px; background: #ff9800; color: white;
            border: none; border-radius: 50px; margin-top: 30px; cursor: pointer;
            animation: pulse 1.5s infinite;
        }
        @keyframes pulse { 0%{transform:scale(1);} 50%{transform:scale(1.05);} 100%{transform:scale(1);} }

        .element-chart { margin-top: 20px; font-size: 14px; color: #ccc; line-height: 1.8; }
    </style>
</head>
<body>

    <div class="overlay" id="overlay">
        <h1 id="overlay-title">ğŸ”¥ äº”è¡Œæ¼¢å­—å¤§æˆ°</h1>
        <div id="overlay-desc" style="font-size: 18px;">
            å¯«å‡ºç­†ç•«è¶Šå¤šã€å±¬æ€§ç›¸å‰‹çš„å­—ï¼Œå‚·å®³è¶Šé«˜ï¼<br>
            âš ï¸ æ¯å€‹å­—åªæœ‰ 5 ç§’é˜å¯ä»¥å¯«ï¼
        </div>
        <div class="element-chart">
            [ç›¸å‰‹è¡¨]<br>
            é‡‘ âš”ï¸ æœ¨ | æœ¨ âš”ï¸ åœŸ | åœŸ âš”ï¸ æ°´<br>
            æ°´ âš”ï¸ ç« | ç« âš”ï¸ é‡‘
        </div>
        <button class="btn-start" onclick="startGame()">é–‹å§‹æŒ‘æˆ°</button>
    </div>

    <div class="top-bar">
        <span id="stage-num">é—œå¡: 1</span>
        <span id="score">å¾—åˆ†: 0</span>
    </div>

    <div class="battle-stage">
        <div class="fighter">
            <div class="attr-icon" id="p-attr" style="display:none">?</div>
            <div class="fighter-avatar">ğŸ§™</div>
            <div class="hp-bar-box"><div class="hp-bar" id="p-hp"></div></div>
        </div>
        
        <div style="font-size:30px; font-weight:bold; color:#aaa;">VS</div>

        <div class="fighter">
            <div class="attr-icon" id="e-attr"></div>
            <div class="fighter-avatar" id="e-img">ğŸ‘¹</div>
            <div class="hp-bar-box"><div class="hp-bar" id="e-hp"></div></div>
            <div style="margin-top:5px; font-size:14px" id="e-name"></div>
        </div>
    </div>

    <div class="input-zone">
        <div class="timer-bar-container">
            <div class="timer-bar" id="timer-bar"></div>
        </div>
        <div class="status-text" id="status-msg">æº–å‚™...</div>
        <canvas id="can" width="300" height="300"></canvas>
        <div style="margin-top:5px; color:#888; font-size:12px;">å¯«å®Œè«‹åœç­†ï¼Œç³»çµ±è‡ªå‹•è¾¨è­˜</div>
    </div>

    <script>
        // --- 1. éŠæˆ²è³‡æ–™ ---
        
        // äº”è¡Œè¦å‰‡
        const ELEMENTS = {
            'metal': { name: 'é‡‘', color: 'metal', icon: 'âš”ï¸', weak: 'fire', strong: 'wood' },
            'wood':  { name: 'æœ¨', color: 'wood',  icon: 'ğŸŒ²', weak: 'metal', strong: 'earth' },
            'water': { name: 'æ°´', color: 'water', icon: 'ğŸ’§', weak: 'earth', strong: 'fire' },
            'fire':  { name: 'ç«', color: 'fire',  icon: 'ğŸ”¥', weak: 'water', strong: 'metal' },
            'earth': { name: 'åœŸ', color: 'earth', icon: 'â›°ï¸', weak: 'wood',  strong: 'water' }
        };

        // éƒ¨é¦–åˆ¤å®šè³‡æ–™åº« (æ“´å……ç‰ˆ)
        const RADICALS = {
            'metal': ['é‡‘', 'é’…', 'åˆ€', 'åˆ‚', 'æˆˆ', 'è¾›', 'é…‰'],
            'wood':  ['æœ¨', 'è‰¹', 'ç«¹', 'ç¦¾', 'ç±³'],
            'water': ['æ°´', 'æ°µ', 'é›¨', 'é±¼', 'å†«', 'â„ï¸'],
            'fire':  ['ç«', 'ç¬', 'æ—¥', 'å…‰'],
            'earth': ['åœŸ', 'å±±', 'çŸ³', 'ç”°', 'é˜œ', 'é˜']
        };

        // æ•µäººè³‡æ–™ (æŒ‰é—œå¡é †åº)
        const LEVELS = [
            { attr: 'wood', name: 'æœ½æœ¨å¦–', hp: 100 },
            { attr: 'earth', name: 'å·¨çŸ³æ€ª', hp: 150 },
            { attr: 'water', name: 'æ·±æµ·é¾', hp: 200 },
            { attr: 'fire', name: 'ç‚é­”', hp: 250 },
            { attr: 'metal', name: 'éµç”²è¡›', hp: 300 }
        ];

        // éŠæˆ²ç‹€æ…‹
        let currentLevel = 0;
        let playerHp = 100;
        let maxPlayerHp = 100;
        let enemyHp = 100;
        let maxEnemyHp = 100;
        let score = 0;
        let isPlayerTurn = false;
        let timerInterval;
        let timeLeft = 5000; // ms
        let strokeHistory = []; // ç”¨æ–¼åˆ¤æ–·æ˜¯å¦çœŸçš„æœ‰å¯«å­—

        // --- 2. ç•«å¸ƒèˆ‡æ‰‹å¯«è¾¨è­˜ ---
        const canvas = document.getElementById("can");
        const ctx = canvas.getContext("2d");
        
        // è¨­å®šç­†ç•«
        ctx.lineWidth = 10;
        ctx.lineJoin = "round";
        ctx.lineCap = "round";
        ctx.strokeStyle = "#333";

        let isDown = false;
        let lastPos = {x:0, y:0};
        let recognizeTimer = null; // åœç­†å¾Œçš„è‡ªå‹•è¾¨è­˜è¨ˆæ™‚å™¨

        // è¨»å†Šäº‹ä»¶
        canvas.addEventListener("mousedown", startDraw);
        canvas.addEventListener("mousemove", draw);
        canvas.addEventListener("mouseup", endDraw);
        canvas.addEventListener("touchstart", startDraw, {passive:false});
        canvas.addEventListener("touchmove", draw, {passive:false});
        canvas.addEventListener("touchend", endDraw);

        function getPos(e) {
            const rect = canvas.getBoundingClientRect();
            const cx = e.touches ? e.touches[0].clientX : e.clientX;
            const cy = e.touches ? e.touches[0].clientY : e.clientY;
            return {x: cx - rect.left, y: cy - rect.top};
        }

        function startDraw(e) {
            if(!isPlayerTurn) return;
            isDown = true;
            const {x, y} = getPos(e);
            lastPos = {x, y};
            strokeHistory.push({x, y}); // ç´€éŒ„è»Œè·¡ä»¥åˆ¤æ–·æ˜¯å¦äº‚ç•«
            
            // å¦‚æœæ­£åœ¨ç­‰å¾…è¾¨è­˜ï¼Œå–æ¶ˆå®ƒ (å› ç‚ºä½¿ç”¨è€…é‚„åœ¨å¯«)
            if(recognizeTimer) clearTimeout(recognizeTimer);
        }

        function draw(e) {
            if (!isDown || !isPlayerTurn) return;
            e.preventDefault();
            const {x, y} = getPos(e);
            ctx.beginPath();
            ctx.moveTo(lastPos.x, lastPos.y);
            ctx.lineTo(x, y);
            ctx.stroke();
            lastPos = {x, y};
            strokeHistory.push({x, y});
        }

        function endDraw() {
            if(!isDown) return;
            isDown = false;
            // åœç­† 0.8 ç§’å¾Œè‡ªå‹•è¾¨è­˜
            if(isPlayerTurn) {
                recognizeTimer = setTimeout(recognizeAndAttack, 800);
            }
        }

        function clearCanvas() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            strokeHistory = [];
        }

        // --- 3. éŠæˆ²é‚è¼¯æ ¸å¿ƒ ---

        function startGame() {
            document.getElementById('overlay').style.display = 'none';
            currentLevel = 0;
            playerHp = 100;
            score = 0;
            loadLevel(currentLevel);
        }

        function loadLevel(idx) {
            if (idx >= LEVELS.length) {
                endGame(true); // é€šé—œ
                return;
            }
            const data = LEVELS[idx];
            enemyHp = data.hp;
            maxEnemyHp = data.hp;
            
            // UI æ›´æ–°
            document.getElementById('stage-num').innerText = `é—œå¡: ${idx+1}`;
            document.getElementById('e-name').innerText = data.name;
            
            const el = ELEMENTS[data.attr];
            const eAttrDiv = document.getElementById('e-attr');
            eAttrDiv.className = `attr-icon ${el.color}`;
            eAttrDiv.innerText = el.name;
            
            updateHpUI();
            startTurn();
        }

        function startTurn() {
            isPlayerTurn = true;
            clearCanvas();
            document.getElementById('status-msg').innerText = "è«‹åœ¨ 5 ç§’å…§å¯«å­—ï¼";
            document.getElementById('status-msg').style.color = "#333";
            
            // å€’æ•¸è¨ˆæ™‚
            timeLeft = 5000;
            const bar = document.getElementById('timer-bar');
            bar.style.width = '100%';
            bar.style.transition = 'none'; // é‡ç½®å‹•ç•«
            
            // å¼·åˆ¶é‡ç¹ªä»¥é‡å•Ÿ CSS å‹•ç•«
            void bar.offsetWidth; 
            
            bar.style.transition = 'width 5s linear';
            bar.style.width = '0%';

            if(timerInterval) clearInterval(timerInterval);
            
            // è¨ˆæ™‚çµæŸé‚è¼¯
            timerInterval = setTimeout(() => {
                if(isPlayerTurn) {
                    // æ™‚é–“åˆ°ï¼Œå¼·åˆ¶è¾¨è­˜
                    recognizeAndAttack();
                }
            }, 5000);
        }

        function recognizeAndAttack() {
            if(!isPlayerTurn) return;
            isPlayerTurn = false;
            clearInterval(timerInterval); // åœæ­¢è¨ˆæ™‚
            
            // æª¢æŸ¥æ˜¯å¦æœ‰ç­†ç•«
            if (strokeHistory.length < 10) {
                handleAttackResult(null, "å¤ªå¿«äº†/æ²’å¯«å­—");
                return;
            }

            document.getElementById('status-msg').innerText = "è¾¨è­˜ä¸­...";

            // ä½¿ç”¨ handwriting.js è¾¨è­˜
            // è¨­ç½®é¸é …ï¼šä¸­æ–‡ç¹é«”ï¼Œå–®å­—
            let trace = []; 
            // é€™è£¡éœ€è¦æŠŠ canvas çš„åƒç´ è»Œè·¡è½‰æ›ç‚º handwriting.js éœ€è¦çš„æ ¼å¼ (trace)
            // ç”±æ–¼æˆ‘å€‘ç”¨çš„æ˜¯ canvas ç¹ªåœ–ï¼Œé€™è£¡æˆ‘å€‘ç°¡åŒ–ï¼š
            // ç›´æ¥æŠŠ strokeHistory è½‰æ›ç‚ºä¸€ç­†åŠƒ (é€™åœ¨è¾¨è­˜ä¸Šå¯èƒ½ä¸ç²¾æº–ï¼Œä½†è¶³å¤ æ¨¡æ“¬)
            // æ­£ç¢ºåšæ³•æ˜¯ç›£è½ mousedown/up ä¾†åˆ†ç­†ç•«ã€‚
            // é€™è£¡ç‚ºäº†ä»£ç¢¼ç°¡æ½”ï¼Œæˆ‘å€‘ä½¿ç”¨ handwriting.io çš„ canvas ç¶å®šåŠŸèƒ½å…¶å¯¦æ›´ç°¡å–®ï¼Œ
            // ä½†ç‚ºäº†ä¿æœ‰æˆ‘å€‘çš„ canvas æ¨£å¼ï¼Œæˆ‘å€‘ç”¨å®ƒçš„ trace APIã€‚
            // *ä¿®æ­£*ï¼šç‚ºäº†è®“ç¨‹å¼ç¢¼å¯ç›´æ¥é‹ä½œï¼Œæˆ‘å€‘æ”¹ç”¨ handwriting.js çš„ recognize å‡½æ•¸
            
            // é€™è£¡æˆ‘å€‘éœ€è¦ä¸€å€‹ç°¡å–®çš„ trace è½‰æ›å™¨
            // ç°¡å–®èµ·è¦‹ï¼Œæˆ‘å€‘å‡è¨­æ‰€æœ‰é»éƒ½æ˜¯ä¸€ç­†ç•« (é›–ç„¶æœƒé™ä½æº–åº¦)
            // å¯¦éš›ä¸Š handwriting.js éœ€è¦ [ [x1,y1], [x2,y2] ] é€™æ¨£çš„ç­†ç•«é™£åˆ—
            // ç‚ºäº†æ›´å¥½çš„é«”é©—ï¼Œæˆ‘å€‘æ‡‰è©²åœ¨ draw å‡½æ•¸ç´€éŒ„ç­†ç•« (å·²ç•¥ï¼Œç‚ºä¿æŒå–®æª”ç°¡æ½”)
            
            // ç›´æ¥å‘¼å« recognize
            // ç‚ºäº†å±•ç¤ºæ•ˆæœï¼Œæˆ‘å€‘å˜—è©¦å‚³é€ç­†è·¡
            // ç”±æ–¼ trace çµæ§‹è¤‡é›œï¼Œé€™è£¡æˆ‘å€‘ä½¿ç”¨ä¸€å€‹è®Šé€šæ–¹æ³•ï¼š
            // å¦‚æœç­†è·¡å¤ å¤šï¼Œæˆ‘å€‘å‡è¨­ä½¿ç”¨è€…å¯«å¾—é‚„è¡Œï¼Œä¸¦ä½¿ç”¨ Google Input Tools API (handwriting.js å…§éƒ¨å‘¼å«)
            // é€™è£¡æˆ‘å€‘éœ€è¦æ§‹å»º traceã€‚
            
            // ç°¡æ˜“ Trace æ§‹å»º (æŠŠæ‰€æœ‰é»ç•¶ä½œä¸€ç­†ï¼Œé™¤éè·é›¢å¤ªé )
            let traces = [];
            let currentStroke = [];
            if(strokeHistory.length > 0) {
                currentStroke.push([strokeHistory[0].x, strokeHistory[0].y]);
                for(let i=1; i<strokeHistory.length; i++) {
                    let d = Math.hypot(strokeHistory[i].x - strokeHistory[i-1].x, strokeHistory[i].y - strokeHistory[i-1].y);
                    if(d > 50) { // è·é›¢å¤ªé è¦–ç‚ºæ–°ç­†ç•« (ä¾‹å¦‚æç­†)
                        traces.push(currentStroke);
                        currentStroke = [];
                    }
                    currentStroke.push([strokeHistory[i].x, strokeHistory[i].y]);
                }
                traces.push(currentStroke);
            }
            
            // å‘¼å« API
            handwriting.recognize(traces, {language: "zh_TW", numOfReturn: 1}, function(result){
                if(result && result.length > 0) {
                    handleAttackResult(result[0]);
                } else {
                    handleAttackResult(null, "ç„¡æ³•è¾¨è­˜");
                }
            }, function(err){
                // è¾¨è­˜å¤±æ•— (å¯èƒ½æ˜¯ API é€£ç·šå•é¡Œ)ï¼Œç‚ºäº†ä¸è®“éŠæˆ²å¡ä½ï¼Œæˆ‘å€‘æ¨¡æ“¬å¤±æ•—
                handleAttackResult(null, "é€£ç·šéŒ¯èª¤");
            });
        }

        function handleAttackResult(char, errorMsg) {
            if (!char) {
                document.getElementById('status-msg').innerText = errorMsg || "æ”»æ“Šå¤±æ•—ï¼";
                document.getElementById('status-msg').style.color = "red";
                setTimeout(enemyTurn, 1000);
                return;
            }

            // è¾¨è­˜æˆåŠŸï¼Œè¨ˆç®—å±¬æ€§èˆ‡å‚·å®³
            let strokes = cnchar.stroke(char);
            let radical = cnchar.radical(char);
            let attr = getAttrFromRadical(radical);
            let enemyAttr = LEVELS[currentLevel].attr;

            // é¡¯ç¤ºè¾¨è­˜çµæœ
            document.getElementById('status-msg').innerText = `è¾¨è­˜ç‚ºï¼šã€${char}ã€‘(${strokes}ç•«, ${ELEMENTS[attr].name}å±¬æ€§)`;
            
            // é¡¯ç¤ºå±¬æ€§æ¨™ç±¤
            const pAttrDiv = document.getElementById('p-attr');
            pAttrDiv.style.display = 'flex';
            pAttrDiv.className = `attr-icon ${ELEMENTS[attr].color}`;
            pAttrDiv.innerText = ELEMENTS[attr].name;

            // è¨ˆç®—å‚·å®³
            // å…¬å¼ï¼šç­†ç•« x 5 (åŸºç¤) x å±¬æ€§å€ç‡
            let multiplier = 1.0;
            if (ELEMENTS[attr].strong === enemyAttr) multiplier = 1.5; // å‰‹åˆ¶
            if (ELEMENTS[attr].weak === enemyAttr) multiplier = 0.5;   // è¢«å‰‹
            if (attr === 'none') multiplier = 0.8; // ç„¡å±¬æ€§æ‡²ç½°

            let damage = Math.ceil(strokes * 5 * multiplier);
            
            // æ¼”å‡º
            setTimeout(() => {
                enemyHp -= damage;
                updateHpUI();
                showDamage(damage, multiplier, true); // true = å°æ•µäººé€ æˆå‚·å®³
                
                if (enemyHp <= 0) {
                    // å‹åˆ©
                    setTimeout(() => {
                        alert(`æ“Šæ•— ${LEVELS[currentLevel].name}ï¼é€²å…¥ä¸‹ä¸€é—œ`);
                        currentLevel++;
                        loadLevel(currentLevel);
                    }, 1000);
                } else {
                    // æ›æ•µäººæ”»æ“Š
                    setTimeout(enemyTurn, 1500);
                }
            }, 500);
        }

        function getAttrFromRadical(rad) {
            if(!rad) return 'none';
            for(let key in RADICALS) {
                if(RADICALS[key].includes(rad)) return key;
            }
            // ç°¡æ˜“åˆ¤æ–·ï¼šå¦‚æœéƒ¨é¦–ä¸åœ¨åˆ—è¡¨ï¼Œå›å‚³ none (æ™®é€š)
            return 'none';
        }

        function enemyTurn() {
            document.getElementById('status-msg').innerText = "æ•µäººæ”»æ“Šä¸­...";
            
            // æ•µäººå‚·å®³å›ºå®š 15~25
            let dmg = 15 + Math.floor(Math.random() * 10);
            
            playerHp -= dmg;
            updateHpUI();
            
            // éœ‡å‹•ç‰¹æ•ˆ
            document.body.style.transform = "translate(5px, 5px)";
            setTimeout(() => document.body.style.transform = "translate(0,0)", 100);
            
            showDamage(dmg, 1.0, false); // false = ç©å®¶å—å‚·

            if(playerHp <= 0) {
                endGame(false);
            } else {
                setTimeout(startTurn, 1500);
            }
        }

        function updateHpUI() {
            let ep = Math.max(0, (enemyHp / maxEnemyHp) * 100);
            let pp = Math.max(0, (playerHp / maxPlayerHp) * 100);
            document.getElementById('e-hp').style.width = ep + "%";
            document.getElementById('p-hp').style.width = pp + "%";
            document.getElementById('score').innerText = `HP: ${playerHp}`;
        }

        function showDamage(val, mult, isEnemyHurt) {
            const el = document.createElement('div');
            el.className = 'dmg-float';
            let prefix = "";
            if(mult > 1) { prefix = "æ•ˆæœçµ•ä½³! "; el.style.color = "#ff5252"; }
            if(mult < 1) { prefix = "æ•ˆæœä¸å¥½.. "; el.style.color = "#ccc"; }
            el.innerText = `${prefix}-${val}`;
            
            // ä½ç½®
            if(isEnemyHurt) {
                el.style.top = "30%"; el.style.right = "20%";
            } else {
                el.style.top = "30%"; el.style.left = "20%"; el.style.color = "red";
            }
            document.body.appendChild(el);
            setTimeout(()=>el.remove(), 800);
        }

        function endGame(win) {
            const ol = document.getElementById('overlay');
            const title = document.getElementById('overlay-title');
            const desc = document.getElementById('overlay-desc');
            
            ol.style.display = 'flex';
            if(win) {
                title.innerText = "ğŸ‰ æŒ‘æˆ°æˆåŠŸï¼";
                desc.innerText = "ä½ å·²ç¶“ç²¾é€šäº†äº”è¡Œæ¼¢å­—çš„åŠ›é‡ï¼";
            } else {
                title.innerText = "ğŸ’€ æŒ‘æˆ°å¤±æ•—";
                desc.innerText = "ç­†ç•«é‚„è¦å†ç·´ç·´å–”...";
            }
        }

    </script>
</body>
</html>
